{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bolad/Downloads/SoloBotAgency_SaaS_Starter/app/api/bots/ai-sales-agent/icebreakers/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport OpenAI from \"openai\";\r\n\r\nconst client = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });\r\n\r\nexport async function POST(req: Request) {\r\n  try {\r\n    const body = await req.json();\r\n    const { targetAudience, companyName } = body;\r\n\r\n    const systemPrompt = `\r\n      You are an expert Copywriter specializing in Cold Email Openers.\r\n      Your goal is to pass the \"3-second test\" â€” prove you are human immediately.\r\n\r\n      **GENERATE 5 ICEBREAKERS PER CATEGORY (Strictly <110 chars each):**\r\n      \r\n      1. **observation:** Neutral, specific observation about their industry/role.\r\n      2. **flattery:** Subtle compliment on a likely achievement (NO cringe/over-the-top praise).\r\n      3. **humor:** Witty, self-deprecating, or industry-inside joke. Subtle.\r\n      4. **question:** A provoking question that hits a pain point immediately.\r\n      5. **commonGround:** \"Fellow [Role]...\" or shared struggle.\r\n      6. **customSmart:** High-IQ industry insight or data-driven opener.\r\n\r\n      **OUTPUT:** Return valid JSON: { \"observation\": [], \"flattery\": [], \"humor\": [], \"question\": [], \"commonGround\": [], \"customSmart\": [] }\r\n    `;\r\n\r\n    const userPrompt = `\r\n      **Target:** ${targetAudience}\r\n      **Company:** ${companyName || \"Their Company\"}\r\n      \r\n      Generate the list now.\r\n    `;\r\n\r\n    const completion = await client.chat.completions.create({\r\n      model: \"gpt-4o-mini\",\r\n      messages: [\r\n        { role: \"system\", content: systemPrompt },\r\n        { role: \"user\", content: userPrompt }\r\n      ],\r\n      response_format: { type: \"json_object\" },\r\n      temperature: 0.8,\r\n    });\r\n\r\n    const parsed = JSON.parse(completion.choices[0].message.content || \"{}\");\r\n\r\n    // Flatten logic: \r\n    // We prioritize the new \"customSmart\" and \"question\" categories at the top of the list \r\n    // to give the user the highest converting options first in their UI list.\r\n    const curatedList = [\r\n      ...(parsed.customSmart || []),\r\n      ...(parsed.question || []),\r\n      ...(parsed.observation || []),\r\n      ...(parsed.humor || []),\r\n      ...(parsed.commonGround || []),\r\n      ...(parsed.flattery || [])\r\n    ].slice(0, 20); // Return top 20 mixed\r\n\r\n    return NextResponse.json({ result: curatedList });\r\n\r\n  } catch (error) {\r\n    console.error(\"Icebreaker API Error:\", error);\r\n    return NextResponse.json({ error: \"Failed to generate icebreakers.\" }, { status: 500 });\r\n  }\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;;;AAEA,MAAM,SAAS,IAAI,mLAAM,CAAC;IAAE,QAAQ,QAAQ,GAAG,CAAC,cAAc;AAAC;AAExD,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EAAE,cAAc,EAAE,WAAW,EAAE,GAAG;QAExC,MAAM,eAAe,CAAC;;;;;;;;;;;;;;IActB,CAAC;QAED,MAAM,aAAa,CAAC;kBACN,EAAE,eAAe;mBAChB,EAAE,eAAe,gBAAgB;;;IAGhD,CAAC;QAED,MAAM,aAAa,MAAM,OAAO,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;YACtD,OAAO;YACP,UAAU;gBACR;oBAAE,MAAM;oBAAU,SAAS;gBAAa;gBACxC;oBAAE,MAAM;oBAAQ,SAAS;gBAAW;aACrC;YACD,iBAAiB;gBAAE,MAAM;YAAc;YACvC,aAAa;QACf;QAEA,MAAM,SAAS,KAAK,KAAK,CAAC,WAAW,OAAO,CAAC,EAAE,CAAC,OAAO,CAAC,OAAO,IAAI;QAEnE,kBAAkB;QAClB,wFAAwF;QACxF,0EAA0E;QAC1E,MAAM,cAAc;eACd,OAAO,WAAW,IAAI,EAAE;eACxB,OAAO,QAAQ,IAAI,EAAE;eACrB,OAAO,WAAW,IAAI,EAAE;eACxB,OAAO,KAAK,IAAI,EAAE;eAClB,OAAO,YAAY,IAAI,EAAE;eACzB,OAAO,QAAQ,IAAI,EAAE;SAC1B,CAAC,KAAK,CAAC,GAAG,KAAK,sBAAsB;QAEtC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,QAAQ;QAAY;IAEjD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAkC,GAAG;YAAE,QAAQ;QAAI;IACvF;AACF"}}]
}