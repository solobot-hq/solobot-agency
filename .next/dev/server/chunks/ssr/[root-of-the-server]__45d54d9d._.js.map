{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bolad/Downloads/SoloBotAgency_SaaS_Starter/lib/usage.ts"],"sourcesContent":["// FREE LIMIT RULE  \r\nexport const FREE_LIMIT = 3;\r\n\r\n/**\r\n * MOCK IMPLEMENTATION â€“ works even without Firebase.\r\n */\r\nconst mockDb: Record<string, number> = {};\r\n\r\nexport async function getUsage(userId: string) {\r\n  return { count: mockDb[userId] || 0 };\r\n}\r\n\r\nexport async function incrementUsage(userId: string) {\r\n  mockDb[userId] = (mockDb[userId] || 0) + 1;\r\n  return { count: mockDb[userId] };\r\n}\r\n"],"names":[],"mappings":"AAAA,oBAAoB;;;;;;;;;AACb,MAAM,aAAa;AAE1B;;CAEC,GACD,MAAM,SAAiC,CAAC;AAEjC,eAAe,SAAS,MAAc;IAC3C,OAAO;QAAE,OAAO,MAAM,CAAC,OAAO,IAAI;IAAE;AACtC;AAEO,eAAe,eAAe,MAAc;IACjD,MAAM,CAAC,OAAO,GAAG,CAAC,MAAM,CAAC,OAAO,IAAI,CAAC,IAAI;IACzC,OAAO;QAAE,OAAO,MAAM,CAAC,OAAO;IAAC;AACjC"}},
    {"offset": {"line": 62, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bolad/Downloads/SoloBotAgency_SaaS_Starter/lib/stripe.ts"],"sourcesContent":["import Stripe from \"stripe\";\n\nexport const stripe = new Stripe(\n  process.env.STRIPE_SECRET_KEY || \"\",\n  {\n    apiVersion: \"2024-06-20\",\n    typescript: true,\n  }\n);\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,SAAS,IAAI,iKAAM,CAC9B,QAAQ,GAAG,CAAC,iBAAiB,IAAI,IACjC;IACE,YAAY;IACZ,YAAY;AACd"}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bolad/Downloads/SoloBotAgency_SaaS_Starter/lib/subscription.ts"],"sourcesContent":["import { currentUser } from \"@clerk/nextjs/server\";\r\nimport { stripe } from \"@/lib/stripe\";\r\n\r\n// ðŸ”¥ CENTRAL ADMIN BYPASS LIST\r\nconst ADMIN_EMAILS = [\r\n  \"solobotagency@gmail.com\", \r\n];\r\n\r\nexport async function getUserSubscriptionStatus(userId: string) {\r\n  try {\r\n    const user = await currentUser();\r\n\r\n    if (!userId || !user) {\r\n      return { isPremium: false, plan: null };\r\n    }\r\n\r\n    const email = user.emailAddresses[0]?.emailAddress;\r\n\r\n    // ðŸ”¥ ALWAYS UNLOCK FOR OWNER & ADMINS\r\n    if (email && ADMIN_EMAILS.includes(email)) {\r\n      return { isPremium: true, plan: \"ADMIN\" };\r\n    }\r\n\r\n    if (!email) {\r\n      return { isPremium: false, plan: null };\r\n    }\r\n\r\n    // NORMAL USER â†’ CHECK STRIPE\r\n    const customers = await stripe.customers.list({\r\n      email,\r\n      limit: 1,\r\n      expand: [\"data.subscriptions\"],\r\n    });\r\n\r\n    const customer = customers.data[0];\r\n    if (!customer) return { isPremium: false, plan: null };\r\n\r\n    const subs = customer.subscriptions?.data || [];\r\n    const active = subs.find(\r\n      (s) => s.status === \"active\" || s.status === \"trialing\"\r\n    );\r\n\r\n    if (!active) {\r\n      return { isPremium: false, plan: null };\r\n    }\r\n\r\n    return {\r\n      isPremium: true,\r\n      plan: active.items.data[0]?.price.nickname || \"PRO\",\r\n    };\r\n  } catch (err) {\r\n    console.error(\"SUBSCRIPTION ERROR:\", err);\r\n    return { isPremium: false, plan: null };\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,+BAA+B;AAC/B,MAAM,eAAe;IACnB;CACD;AAEM,eAAe,0BAA0B,MAAc;IAC5D,IAAI;QACF,MAAM,OAAO,MAAM,IAAA,yMAAW;QAE9B,IAAI,CAAC,UAAU,CAAC,MAAM;YACpB,OAAO;gBAAE,WAAW;gBAAO,MAAM;YAAK;QACxC;QAEA,MAAM,QAAQ,KAAK,cAAc,CAAC,EAAE,EAAE;QAEtC,sCAAsC;QACtC,IAAI,SAAS,aAAa,QAAQ,CAAC,QAAQ;YACzC,OAAO;gBAAE,WAAW;gBAAM,MAAM;YAAQ;QAC1C;QAEA,IAAI,CAAC,OAAO;YACV,OAAO;gBAAE,WAAW;gBAAO,MAAM;YAAK;QACxC;QAEA,6BAA6B;QAC7B,MAAM,YAAY,MAAM,uHAAM,CAAC,SAAS,CAAC,IAAI,CAAC;YAC5C;YACA,OAAO;YACP,QAAQ;gBAAC;aAAqB;QAChC;QAEA,MAAM,WAAW,UAAU,IAAI,CAAC,EAAE;QAClC,IAAI,CAAC,UAAU,OAAO;YAAE,WAAW;YAAO,MAAM;QAAK;QAErD,MAAM,OAAO,SAAS,aAAa,EAAE,QAAQ,EAAE;QAC/C,MAAM,SAAS,KAAK,IAAI,CACtB,CAAC,IAAM,EAAE,MAAM,KAAK,YAAY,EAAE,MAAM,KAAK;QAG/C,IAAI,CAAC,QAAQ;YACX,OAAO;gBAAE,WAAW;gBAAO,MAAM;YAAK;QACxC;QAEA,OAAO;YACL,WAAW;YACX,MAAM,OAAO,KAAK,CAAC,IAAI,CAAC,EAAE,EAAE,MAAM,YAAY;QAChD;IACF,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO;YAAE,WAAW;YAAO,MAAM;QAAK;IACxC;AACF"}},
    {"offset": {"line": 148, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bolad/Downloads/SoloBotAgency_SaaS_Starter/app/dashboard/ai-sales-agent/lib/paywall.ts"],"sourcesContent":["\"use server\";\r\n\r\nimport { auth } from \"@clerk/nextjs/server\";\r\nimport { FREE_LIMIT, getUsage, incrementUsage } from \"@/lib/usage\";\r\nimport { getUserSubscriptionStatus } from \"@/lib/subscription\";\r\nimport { stripe } from \"@/lib/stripe\";\r\nimport { redirect } from \"next/navigation\";\r\n\r\n// HARD ADMIN OVERRIDE â€“ UNLIMITED ACCESS\r\nconst ADMIN_EMAIL = \"solobotagency@gmail.com\";\r\n\r\nexport async function checkUsage() {\r\n  const { userId } = auth();\r\n\r\n  if (!userId) {\r\n    return { usage: 0, remaining: 0, limit: FREE_LIMIT, isLocked: true, isPremium: false };\r\n  }\r\n\r\n  // Get subscription + user email\r\n  const sub = await getUserSubscriptionStatus(userId);\r\n\r\n  // â­ ADMIN ALWAYS UNLOCKED â­\r\n  if (sub.plan === \"ADMIN\") {\r\n    return {\r\n      usage: 0,\r\n      remaining: 9999,\r\n      limit: FREE_LIMIT,\r\n      isLocked: false,\r\n      isPremium: true,\r\n      plan: \"ADMIN\",\r\n    };\r\n  }\r\n\r\n  // â­ PREMIUM UNLOCKED â­\r\n  if (sub.isPremium) {\r\n    return {\r\n      usage: 0,\r\n      remaining: 9999,\r\n      limit: FREE_LIMIT,\r\n      isLocked: false,\r\n      isPremium: true,\r\n      plan: sub.plan,\r\n    };\r\n  }\r\n\r\n  // FREE USER LOGIC\r\n  const data = await getUsage(userId);\r\n  const used = data.count || 0;\r\n\r\n  return {\r\n    usage: used,\r\n    remaining: Math.max(0, FREE_LIMIT - used),\r\n    limit: FREE_LIMIT,\r\n    isLocked: used >= FREE_LIMIT,\r\n    isPremium: false,\r\n  };\r\n}\r\n\r\nexport async function trackUsage() {\r\n  const { userId } = auth();\r\n  if (!userId) return;\r\n\r\n  const sub = await getUserSubscriptionStatus(userId);\r\n\r\n  // Admin / premium â†’ do NOT count usage\r\n  if (sub.plan === \"ADMIN\" || sub.isPremium) return;\r\n\r\n  await incrementUsage(userId);\r\n}\r\n\r\nexport async function createCheckoutSession() {\r\n  const { userId } = auth();\r\n  if (!userId) return;\r\n\r\n  const priceId = process.env.STRIPE_PRO_MONTHLY_PRICE_ID;\r\n  const appUrl = process.env.NEXT_PUBLIC_APP_URL;\r\n\r\n  if (!priceId) {\r\n    console.error(\"Missing price ID\");\r\n    return;\r\n  }\r\n\r\n  const session = await stripe.checkout.sessions.create({\r\n    mode: \"subscription\",\r\n    line_items: [{ price: priceId, quantity: 1 }],\r\n    metadata: { userId },\r\n    success_url: `${appUrl}/dashboard/ai-sales-agent?success=true`,\r\n    cancel_url: `${appUrl}/dashboard/ai-sales-agent?canceled=true`,\r\n  });\r\n\r\n  redirect(session.url!);\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;AAEA;AACA;AACA;AACA;AACA;AAAA;;;;;;;;AAEA,yCAAyC;AACzC,MAAM,cAAc;AAEb,eAAe;IACpB,MAAM,EAAE,MAAM,EAAE,GAAG,IAAA,2LAAI;IAEvB,IAAI,CAAC,QAAQ;QACX,OAAO;YAAE,OAAO;YAAG,WAAW;YAAG,OAAO,0HAAU;YAAE,UAAU;YAAM,WAAW;QAAM;IACvF;IAEA,gCAAgC;IAChC,MAAM,MAAM,MAAM,IAAA,gJAAyB,EAAC;IAE5C,4BAA4B;IAC5B,IAAI,IAAI,IAAI,KAAK,SAAS;QACxB,OAAO;YACL,OAAO;YACP,WAAW;YACX,OAAO,0HAAU;YACjB,UAAU;YACV,WAAW;YACX,MAAM;QACR;IACF;IAEA,uBAAuB;IACvB,IAAI,IAAI,SAAS,EAAE;QACjB,OAAO;YACL,OAAO;YACP,WAAW;YACX,OAAO,0HAAU;YACjB,UAAU;YACV,WAAW;YACX,MAAM,IAAI,IAAI;QAChB;IACF;IAEA,kBAAkB;IAClB,MAAM,OAAO,MAAM,IAAA,wHAAQ,EAAC;IAC5B,MAAM,OAAO,KAAK,KAAK,IAAI;IAE3B,OAAO;QACL,OAAO;QACP,WAAW,KAAK,GAAG,CAAC,GAAG,0HAAU,GAAG;QACpC,OAAO,0HAAU;QACjB,UAAU,QAAQ,0HAAU;QAC5B,WAAW;IACb;AACF;AAEO,eAAe;IACpB,MAAM,EAAE,MAAM,EAAE,GAAG,IAAA,2LAAI;IACvB,IAAI,CAAC,QAAQ;IAEb,MAAM,MAAM,MAAM,IAAA,gJAAyB,EAAC;IAE5C,uCAAuC;IACvC,IAAI,IAAI,IAAI,KAAK,WAAW,IAAI,SAAS,EAAE;IAE3C,MAAM,IAAA,8HAAc,EAAC;AACvB;AAEO,eAAe;IACpB,MAAM,EAAE,MAAM,EAAE,GAAG,IAAA,2LAAI;IACvB,IAAI,CAAC,QAAQ;IAEb,MAAM,UAAU,QAAQ,GAAG,CAAC,2BAA2B;IACvD,MAAM,SAAS,QAAQ,GAAG,CAAC,mBAAmB;IAE9C,IAAI,CAAC,SAAS;QACZ,QAAQ,KAAK,CAAC;QACd;IACF;IAEA,MAAM,UAAU,MAAM,uHAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,MAAM,CAAC;QACpD,MAAM;QACN,YAAY;YAAC;gBAAE,OAAO;gBAAS,UAAU;YAAE;SAAE;QAC7C,UAAU;YAAE;QAAO;QACnB,aAAa,GAAG,OAAO,sCAAsC,CAAC;QAC9D,YAAY,GAAG,OAAO,uCAAuC,CAAC;IAChE;IAEA,IAAA,iMAAQ,EAAC,QAAQ,GAAG;AACtB;;;IAhFsB;IA+CA;IAYA;;AA3DA,+OAAA;AA+CA,+OAAA;AAYA,+OAAA"}}]
}